## Introduction
This repository contains the notebooks and scripts for analyzing cell count data for the Franco Lab. The scripts are designed to facilitate statistical analysis and visualization of cell marker data, and help assess differences between experimental groups. Typically, the Franco Lab counts cells in the dorsal pallium or cortex of mouse embryonic or postnatal brains. These examples are from the mouse embryonic cortex.

This repo includes example data and scripts to perform statistical analysis and make barplots for data containing the % of electroporated cells that are marker+, but it can be adapted for data containing the # of marker+cells per area just by changing the labels.

There are example analyses comparing:
* Two experimental groups
* Four experimental groups

Additionally, this repo contains notebooks and markdown files that:
* Provide example workflows
* Include code, notes, and comments
* Embed results for easier interpretation
* Include code with flexible variables that can be changed based on the specific experiment, such as markers or treatment groups

---

## Overview
This repo provides: 
* data preprocessing and cleaning functions
* statistical analysis workflows (normality tests, variance tests, significance tests)
* data visualization using ggplot2
* package setup
---

## Table of Contents

- [Setup](#setup)
- [Data](#data)
- [Scripts](#scripts)
- [Notebooks](#notebooks)
- [Results](#results)

---

## Setup
The majority of this project was done using R (v 4.3.2).

Before running any analysis or generating figures, you need to set up the environment using the '00_setup_packges.R' script. This will ensure all dependencies are installed.

### To run the setup:

1. Clone the repository:
   ```bash
   git clone https://github.com/luulintran/francolab_cellcountanalysis_R.git
   cd francolab_cellcountanalysis_R
   ```

2. Run the setup script to install the required dependencies:
    ```
    Rscript scripts/00_setup_packages.R
    ```

## Data

This repo is meant to regenerate figures starting with CSV files containing cell counts. Typically, I will divide images into equal bins. These bins can either be columns spanning the entire dorsal pallium to make counting electroporated cells easier. Or, if I want the # of marker+ cells per defined area, the bins will be squares of the same area spanning the entire dorsal pallium. I use image J's Cell Count Analysis feature to count cells, and I use an excel spreadsheet to keep track of cell counts. This excel sheet serves as a "map" of the cell counts over the images from each brain. I will then input the average number of cells or average % of cells into a separate CSV file with the columns:  

`treatment, brain_id, marker_1, marker_2, etc`

To make a csv file you can input data in Excel and then save it as CSV. It is best to keep this csv file containing your data "tidy", meaning there is a column for each variable, a row for each observation, and each value is stored in its own cell with no units. For more on "tidy" data, read more [here](https://r4ds.had.co.nz/tidy-data.html).  

There is a template data file called `cellcountdata_template.csv` that you can fill it, replacing marker1-3 columns with the markers you are counting

The `data/` directory contains example datasets from in utero electroporation experiments:  
* These datasets contain data from experiments where the primary focus is on calculating the percentage of electroporated cells for each marker. 

* The data is provided in two groups or four groups for comparison

## Scripts

The `scripts` directory contains scripts for preprocessing data, performing statistical analysis, and generating barplots for the 2 types of datasets described above. 

You can run the scripts in numerical order to ensure proper workflow and see the results of each step. Or you can simply run script `03_make_barplots...R` because it uses `source()` to run the previous scripts.

You can run the script(s) in command line:
   ```bash
   Rscript scripts/scripts_2groups/03_make_barplots_percentage_2groups.R
   ```

The barplots generated by these scripts will be saved in the `results/` directory.

## Notebooks

The `notebooks` directory contains the R Studio notebooks and R Markdown files that provide a detailed, step-by-step approach to preprocess and analyze the 2 types of datasets described in the Data section. These notebooks include code, notes, and resulting barplots embedded within the notebooks for easier understanding and exploration. 

You can save a copy of the markdown files and replace the variables so that it applies to your data. This way you can follow along and replace variables as you analyze the data. Most variables are defined at the top of the markdown file. 

## Results

The `results/` directory contains the figures generated from running the scripts, primarily focusing on barplots. These figures are saved as PDF files, making them easy to further customize in applications like Adobe Illustrator.